{% load static %}

<!DOCTYPE html><!-- This site was created in Webflow. http://www.webflow.com --><!-- Last Published: Mon Jun 14 2021 20:30:44 GMT+0000 (Coordinated Universal Time) -->
<html data-wf-domain="dawn-dashboard.webflow.io" data-wf-page="60248a71d59b202290e73f5a" data-wf-site="6022ffeab6f354c9aa1eb2a2">

<head>
	<meta charset="utf-8" />
	<title>Nftion Dashboard - The Best NFT Analytics Tool</title>
	<meta content="Nftion Dashboard - The Best NFT Analytics Tool." property="og:title" />
	<meta content="Nftion Dashboard - The Best NFT Analytics Tool." property="twitter:title" />
	<meta content="width=device-width, initial-scale=1" name="viewport" />
	<link href="{% static 'css/dawn-dashboard.webflow.fad9e2a6a.css' %}" rel="stylesheet" type="text/css" />
	<link href="{% static 'dashboard_extras/css/_extra_css.css' %}" rel="stylesheet" type="text/css" />
	  <link rel="icon" type="image/x-icon" href="{% static 'img/imgs/logo34.svg' %}">

	<style>
		.w-webflow-badge {
		   display: None !important;
		   visibility: hidden !important;
		}
        #email_form_correct, #email_form_error, #password_form_correct, #password_form_error{
            display: none;
        }
        .correct-form{
margin-bottom: 16px;
    padding: 16px 16px;
    border-style: solid;
    border-width: 1px;
    border-color: #dfe3eb;
    border-radius: 4px;
    background-color: #dff0d8;
    color: #3c763d;
    font-size: 15px;
    line-height: 16px;
            text-align: center;
        }
        .error-form{
margin-bottom: 16px;
    padding: 16px 16px;
    border-style: solid;
    border-width: 1px;
    border-color: #f2dede;
    border-radius: 4px;
    background-color: #f2dede;
    color: #a94442;
    font-size: 15px;
    line-height: 16px;
            text-align: center;
        }
	</style>
</head>

<body>
	<div class="wrapper">
    {% include 'partials/redirecting_part.html' %}
		<div data-collapse="all" data-animation="default" data-duration="400" role="banner" class="simple-nav w-nav">
			<a href="/" class="dashboard-logo w-nav-brand">
			<img src="{% static 'img/imgs/logo.png' %}" width="98" alt="" class="sidebar-logo" /></a>
			<div class="nav-spacer"></div>
			<a href="{% url 'home:dashboard' %}" class="nav-link cta margin-right w-nav-link">Back to Dashboard</a>
			
			<div data-hover="" data-delay="0" class="profile-menu-dropdown w-dropdown">
                <div data-w-id="b24ef7f8-86e5-1c85-e1c5-b65466441b29" class="profile-menu w-dropdown-toggle">
                    <div class="profile-image">
                        <img src="{% if user_profile.avatar %}{{ user_profile.avatar.url }}{% else %}{% static 'img/imgs/avatar.png' %}{% endif %}" loading="lazy" alt="" class="cover-image" />
                    </div>
                    <img src="https://assets.website-files.com/6022ffeab6f354c9aa1eb2a2/6023423b0a5988466e83ffb8_CaretDown.svg" loading="lazy" width="15" alt="" class="menu-down" />
                </div>
                <nav class="profile-menu-list w-dropdown-list">
                    <a href="{% url 'home:profile' %}" class="profile-menu-link w-nav-link">My Profile</a>
                    <a href="{% url 'home:settings' %}" class="profile-menu-link w-nav-link">Settings</a>
                    <div class="menu-divider"></div>
                    <a href="{% url 'home:support' %}" class="profile-menu-link w-nav-link">Report an Issue</a>
                    <a href="{% url 'home:terms_conditions' %}" class="profile-menu-link w-nav-link">Terms &amp; Conditions</a>
                    <a href="{% url 'home:privacy-policy' %}" class="profile-menu-link w-nav-link">Privacy Policy</a>
                    <div class="menu-divider"></div>
                    <a href="{% url 'auth:logout' %}" class="profile-menu-link w-nav-link">Log Out</a>
                </nav>
            </div>
		</div>
        
		<div class="main-content">
			<div class="container w-container">
				<h1 class="page-title">Settings</h1>
			</div>
			<div class="_1-2-5-grid">
				<div class="module sticky">
					<div class="menu-list-section"><a href="#Email" class="menu-link w-inline-block">
							<div class="sidebar-link-text">Account Settings</div>
						</a>
						<a href="#Password" class="menu-link w-inline-block">
							<div class="sidebar-link-text">Password</div>
						</a>


					</div>
				</div>
				<div class="module-group">
					<div id="Email" class="module">
						<div class="module-header minimal">
							<h3 class="module-heading">Email</h3>
						</div>
						<div class="module-main">
							<div class="w-form">
								<form id="email-form" name="email-form" data-name="Email Form" class="form">
									<div class="field-block">
										<label for="old_email">Old Email</label>
										<input type="email" maxlength="256" id="old_email" disabled value="{{ user_profile.user.email }}" name="old_email" data-name="Name 2" class="text-input w-input" />
									</div>
									<div class="field-block">
										<label for=new_email">New Email</label>
										<input type="email" maxlength="256" id="new_email" name="new_email" data-name="Profile Email 2" class="text-input w-input" />
                                        <span id="failed_new_email"></span>
									</div>
									<input type="submit" id="submit_btn" value="Change" data-wait="Please wait..." class="button settings w-button" />
									<div class="field-block">
										<label for="profile-email-2">Enter your code</label>
										<div class="code-box-block">
											<input type="text" maxlength="6" id="code_verify_email" name="code_verify" data-name="Profile Email 2" class="text-input w-input" />
											<input type="submit" value="Submit" id="code_verify_btn" data-wait="Please wait..." class="button settings w-button code-box-block-button" />
										</div>
                                        {% csrf_token %}
										<p class="resend-code">Still didn't receive the code? <a href="" id="send_again_email">Press here</a>.</p>
									</div>

								</form>
								  <div class="correct-form" id="email_form_correct">
                                    We&#x27;ve updated your account. You will be redirected in 2 seconds.
                                </div>
                                <div class="error-form" id="email_form_error">
                                    Oops! Something went wrong. Please fill in the required fields and try again.
                                </div>
							</div>
						</div>
					</div>
					<div id="Password" class="module">
						<div class="module-header minimal">
							<h3 class="module-heading">Password</h3>
						</div>
						<div class="module-main">
							<div class="w-form">
								<form id="password-form" name="email-form" data-name="Email Form" class="form">
									<div class="field-block"><label for="name-2">Old Password</label><input type="password" maxlength="256" id="old_password" name="old_password" data-name="Name 2" class="text-input w-input" /></div>
									<div class="field-block">
										<label for="profile-email-2">New Password</label>
										<input type="password" maxlength="256" id="new_password" name="new_password" data-name="Profile Email 2" class="text-input w-input" />
									</div>
									<input type="submit" id="submit_btn_password" value="Change" data-wait="Please wait..." class="button settings w-button" />
									<div class="field-block">
										<label for="profile-email-2">Enter your code</label>
										<div class="code-box-block">
											<input type="text" maxlength="6" id="code_verify_password" name="code_verify_password" data-name="Profile Email 2" class="text-input w-input" />
											<input type="submit" id="code_verify_password_btn" value="Submit" data-wait="Please wait..." class="button settings w-button code-box-block-button" />

										</div>
										<p class="resend-code">Still didn't receive the code? <a href="" id="send_again_password">Press here</a>.</p>
									</div>
								</form>
                                <div class="correct-form" id="password_form_correct">
                                    We&#x27;ve updated your account. You will be redirected in 2 seconds.
                                </div>
                                <div class="error-form" id="password_form_error">
                                    Oops! Something went wrong. Please fill in the required fields and try again.
                                </div>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>
		<div class="dashboard-footer">
			<p class="paragraph-small light">© Nftion All Rights Reserved・ Designed by <a href="https://onesite.agency" target="_blank" class="simple-link light">OneSite Agency</a></p>
		</div>
	</div><script src="{% static 'js/jquery.min.js' %}" integrity="sha512-tWHlutFnuG0C6nQRlpvrEhE4QpkG1nn2MOUMWmUeRePl4e3Aki0VB6W1v3oLjFtd0hVOtRQ9PHpSfN6u6/QXkQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="{% static 'js/jquery-3.5.1.min.js' %}" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="{% static 'js/webflow.profile.js' %}" type="text/javascript"></script><!--[if lte IE 9]>
<script src="{% static 'js/placeholder.js' %}"></script><![endif]-->
<script src="{% static 'dashboard_extras/js/script_signup.js' %}" type="text/javascript"></script>
</body>
<script>
    let submit_btn = $('#submit_btn')
    let submit_btn_password = $('#submit_btn_password')
    let code_verify_btn = $('#code_verify_btn')
    let code_verify_password_btn = $('#code_verify_password_btn')
    let send_again_password = $('#send_again_password')
    let send_again_email = $('#send_again_email')
        submit_btn.click(function (event){
        event.preventDefault()
    $.ajax({
       type: 'POST',
        url: "{% url 'auth:change_email' %}",
        data:{
            old_email: $('#old_email').val(),
            new_email: $('#new_email').val(),
            csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        },
        success: function (response){
            if (response.message === 'failed'){
                $('#failed_new_email').text('This email already exists in system')
                setTimeout(() => {  $('#failed_new_email').text('') }, 3500);
            }
        }
    })
    })
submit_btn_password.click(function (event){
    event.preventDefault()
    $.ajax({
       type: 'POST',
        url: "{% url 'auth:change_email' %}",
        data:{
            old_password: $('#old_password').val(),
            new_password: $('#new_password').val(),
            csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        },
        success: function (response){
        }
    })
    })
    code_verify_btn.click(function (){
        console.log('qwe')
         $.ajax({
       type: 'POST',
        url: "{% url 'auth:change_email' %}",
        data:{
            code_verify: $('#code_verify_email').val(),
            csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        },
        success: function (response){

            if (response.success === true){
                $('#email_form_correct').css('display', 'block')
                setTimeout(() => {  window.location.href='/profile/'; }, 2500);
            }
            else{
                $('#email_form_error').css('display', 'block')
            }
        }
    })
    })
    code_verify_password_btn.click(function (){
         $.ajax({
       type: 'POST',
        url: "{% url 'auth:change_email' %}",
        data:{
            code_verify: $('#code_verify_password').val(),
            csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        },
        success: function (response){
               if (response.success === true){
                $('#password_form_correct').css('display', 'block')
                setTimeout(() => {  window.location.href='/profile/'; }, 2500);
            }
            else{
                $('#password_form_error').css('display', 'block')
            }
        }
    })
    })

    send_again_password.click(function (event){
        event.preventDefault()
        $.ajax({
            url: "{% url 'auth:change_email' %}",
            type: 'POST',
            data:{
                old_password: $('#old_password').val(),
                new_password: $('#new_password').val(),
                csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        }
        })
    })
        send_again_email.click(function (event){
        event.preventDefault()
        $.ajax({
            url: "{% url 'auth:change_email' %}",
            type: 'POST',
            data:{
                old_email: $('#old_email').val(),
                new_email: $('#new_email').val(),
                csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val(),
        }
        })
    })
</script>
</html>